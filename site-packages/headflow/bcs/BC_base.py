from ..dol import *
from numpy import linspace
from .bcutils import get_area, get_center, get_average_normal

class BC_base(object):
    def __init__(self):
        pass

    def _update(self, t, u):
        return

    def set_t(self, t):
        self.t = t % self.period

    def scale(self, scale_value):
        N = 100
        qt = [0]*100
        for i, t in enumerate(linspace(0, self.period, 100)):
            for e in self: e.set_t(0.0)
            qt[i] = assemble(sqrt(self[0]**2+self[1]**2+self[2]**2)*ds(self.ind),
                             mesh=self.mesh, exterior_facet_domains=self.facet_domains)

        for e in self: e.set_t(0.0)

        q_avg = sum(qt)/len(qt)
        return scale_value / q_avg
