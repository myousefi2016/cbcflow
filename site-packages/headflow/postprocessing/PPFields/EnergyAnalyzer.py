
from .ppfieldbase import PPFieldBase
import dolfin
from math import sqrt 

class EnergyAnalyzer(PPFieldBase): 
    def __init__(self, **kwargs):
        PPFieldBase.__init__(self, **kwargs)

    def update(self, u, p, t, timestep, problem): 
        u0_norm = dolfin.norm (u[0] )
        u1_norm = dolfin.norm (u[1] )         
        u2_norm = dolfin.norm (u[2] )
        energy = sqrt (u0_norm*u0_norm +  u1_norm*u1_norm +u2_norm*u2_norm )
        self.set_data(t, timestep, {"u0" : u0_norm, "u1": u1_norm, "u2": u2_norm, "kinetic energy": energy})
        print "t ", t, " kinetic energy  ", energy  


