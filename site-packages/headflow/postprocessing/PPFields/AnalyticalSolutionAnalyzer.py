
from .ppfieldbase import PPFieldBase
import dolfin

class AnalyticalSolutionAnalyzer(PPFieldBase): 
    def __init__(self, **kwargs):
        PPFieldBase.__init__(self, **kwargs)

    def update(self, u, p, t, timestep, problem): 
        u_anal, p_anal = problem.analytical_solution(t) 
        u0_error = dolfin.errornorm (u_anal[0], u[0] )
        u1_error = dolfin.errornorm (u_anal[1], u[1] )         
        u2_error = dolfin.errornorm (u_anal[2], u[2] )
        p_error = dolfin.errornorm (p_anal, p )
        self.set_data(t, timestep, {"u0" : u0_error, "u1": u1_error, "u2": u2_error, "p": p_error})
        print "t ", t, " error (u0, u1, u2, p) ", u0_error, u1_error, u2_error, p_error 


