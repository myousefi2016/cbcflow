from ppfieldbase import PPFieldBase

from headflow.dol import *

class Velocity(PPFieldBase):
    def __init__(self, **kwargs):
        PPFieldBase.__init__(self, **kwargs)
                
    def before_first_update(self, u, p, t, timestep, problem):
        if isinstance(u, list):
            self.V = VectorFunctionSpace(problem.mesh, "CG", u[0].function_space().ufl_element().degree())
            self.u_vec = Function(self.V)
          
        

    def update(self, u, p, t, timestep, problem):
        tic()
        if isinstance(u, list):
            self.u_vec.assign(project(as_vector(u), self.V))
        else:
            self.u_vec = u
        
        print toc()
        
        self.set_data(t, timestep, self.u_vec)
    
