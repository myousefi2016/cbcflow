from .MetaPPField import MetaPPField
from dolfin import *

class RunningMax(MetaPPField):
    def before_first_compute(self, pp, spaces, problem):
        self._value = float('-inf')

    def compute(self, pp, spaces, problem):
        u = pp.get(self.valuename)

        if isinstance(self._value, float):
            self._value = max(self._value, u)
        else:
            # TODO: Support fields, need to make a copy of underlying space.
            error("Only support scalars.")

        return self._value
