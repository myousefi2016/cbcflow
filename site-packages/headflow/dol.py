
# Always import the entire dolfin namespace
from dolfin import *

# If dolfin_adjoint has already been imported, overwrite the
# dolfin namespace with the overloaded dolfin_adjoint symbols
import sys

has_dolfin_adjoint = ('dolfin_adjoint' in sys.modules)
if has_dolfin_adjoint:
    from dolfin_adjoint import *
else:
    def adj_inc_timestep(*args):
        pass
    def adj_start_timestep(*args):
        pass

# This is a trick to handle automatic timestep annotation
def Time(t0=0.0):
    t = Constant(t0, name="TIME")
    t._assigned_to = False
    return t

def assign_time(t, tvalue):
    t.assign(tvalue)
    if t._assigned_to:
        adj_inc_timestep(tvalue)
    else:
        t._assigned_to = True
        adj_start_timestep(tvalue)
